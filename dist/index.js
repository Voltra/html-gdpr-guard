!function(r,e){"object"==typeof exports&&"object"==typeof module?module.exports=e():"function"==typeof define&&define.amd?define([],e):"object"==typeof exports?exports.htmlGdprGuard=e():r.htmlGdprGuard=e()}("undefined"!=typeof self?self:"undefined"!=typeof window?window:this,(()=>(()=>{var r={845:function(r){var e;"undefined"!=typeof self?self:"undefined"!=typeof window&&window,e=()=>(()=>{"use strict";var r={315:(r,e,t)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.makeGuard=void 0;var n=t(670);e.makeGuard=function(r,e,t,o,i){return void 0===t&&(t=n.GdprStorage.Cookie),void 0===o&&(o=!1),void 0===i&&(i=null),{name:r,description:e,storage:t,required:o,enabled:null===i?o:i,enable:function(){return this.enabled||this.toggle(),this},disable:function(){return this.enabled&&this.toggle(),this},toggle:function(){return this.required||(this.enabled=!this.enabled),this},makeRequired:function(){return this.required=!0,this.enabled=!0,this},isEnabled:function(r){return this.name===r&&this.enabled},enableForStorage:function(r){return this.enabled||this.toggleForStorage(r),this},disableForStorage:function(r){return this.enabled&&this.toggleForStorage(r),this},toggleForStorage:function(r){return this.storage!=r||this.required||this.toggle(),this},raw:function(){return JSON.parse(JSON.stringify(this))}}}},822:function(r,e,t){var n=this&&this.__read||function(r,e){var t="function"==typeof Symbol&&r[Symbol.iterator];if(!t)return r;var n,o,i=t.call(r),a=[];try{for(;(void 0===e||e-- >0)&&!(n=i.next()).done;)a.push(n.value)}catch(r){o={error:r}}finally{try{n&&!n.done&&(t=i.return)&&t.call(i)}finally{if(o)throw o.error}}return a},o=this&&this.__spreadArray||function(r,e,t){if(t||2===arguments.length)for(var n,o=0,i=e.length;o<i;o++)!n&&o in e||(n||(n=Array.prototype.slice.call(e,0,o)),n[o]=e[o]);return r.concat(n||Array.prototype.slice.call(e))},i=this&&this.__values||function(r){var e="function"==typeof Symbol&&Symbol.iterator,t=e&&r[e],n=0;if(t)return t.call(r);if(r&&"number"==typeof r.length)return{next:function(){return r&&n>=r.length&&(r=void 0),{value:r&&r[n++],done:!r}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")};Object.defineProperty(e,"__esModule",{value:!0}),e.GdprGuardGroup=void 0;var a=t(670),u=function(){function r(r,e,t,n){void 0===e&&(e=""),void 0===t&&(t=!1),void 0===n&&(n=!1),this.name=r,this.description=e,this.enabled=t,this.required=n,this.storage=a.GdprStorage.None,this.bindings=new Map,this.required&&(this.enabled=!0)}return r.for=function(e,t,n,o){return void 0===t&&(t=""),void 0===n&&(n=!1),void 0===o&&(o=!1),new r(e,t,n,o)},r.prototype.addGuard=function(r){return this.bindings.set(r.name,r),this},r.prototype.hasGuard=function(r){return this.name===r||this.bindings.has(r)||this.reduceSubGroupsPred((function(e){return e.hasGuard(r)}))},r.prototype.getGuard=function(r){var e,t;return this.name===r?this:null!==(t=null!==(e=this.bindings.get(r))&&void 0!==e?e:this.reduceSubGroups((function(e){return e.getGuard(r)})))&&void 0!==t?t:null},r.prototype.isEnabled=function(r){if(this.hasGuard(r)){var e=this.getGuard(r);if(null!==e)return e.enabled}return!1},r.prototype.enable=function(){return this.required?this:(this.enabled=!0,this.doForEachGuard((function(r){return r.enable()})))},r.prototype.disable=function(){return this.required?this:(this.enabled=!1,this.doForEachGuard((function(r){return r.disable()})))},r.prototype.toggle=function(){return this.enabled?this.disable():this.enable()},r.prototype.makeRequired=function(){return this.required=!0,this.enabled=!0,this.doForEachGuard((function(r){return r.makeRequired()}))},r.prototype.enableForStorage=function(r){return this.required?this:this.doForEachGuard((function(e){e.enableForStorage(r)}))},r.prototype.disableForStorage=function(r){return this.required?this:this.doForEachGuard((function(e){e.disableForStorage(r)}))},r.prototype.toggleForStorage=function(r){return this.required?this:this.doForEachGuard((function(e){e.toggleForStorage(r)}))},r.prototype.raw=function(){var r={name:this.name,description:this.description,enabled:this.enabled,required:this.required,storage:this.storage,guards:[]};return r.guards=o([],n(this.bindings),!1).map((function(r){var e=n(r,2);return e[0],e[1].raw()})),r},r.prototype.doForEachGuard=function(r){return this.bindings.forEach((function(e){return r(e)})),this},r.prototype.reduceSubGroupsPred=function(e){var t,o;try{for(var a=i(this.bindings),u=a.next();!u.done;u=a.next()){var c=n(u.value,2),s=(c[0],c[1]);if(s instanceof r&&e(s))return!0}}catch(r){t={error:r}}finally{try{u&&!u.done&&(o=a.return)&&o.call(a)}finally{if(t)throw t.error}}return!1},r.prototype.reduceSubGroups=function(e){var t,o;try{for(var a=i(this.bindings),u=a.next();!u.done;u=a.next()){var c=n(u.value,2),s=(c[0],c[1]);if(s instanceof r){var l=e(s);if(l)return l}}}catch(r){t={error:r}}finally{try{u&&!u.done&&(o=a.return)&&o.call(a)}finally{if(t)throw t.error}}return null},r.prototype.getGuards=function(){return o([],n(this.bindings.values()),!1)},r}();e.GdprGuardGroup=u},777:function(r,e,t){var n=this&&this.__values||function(r){var e="function"==typeof Symbol&&Symbol.iterator,t=e&&r[e],n=0;if(t)return t.call(r);if(r&&"number"==typeof r.length)return{next:function(){return r&&n>=r.length&&(r=void 0),{value:r&&r[n++],done:!r}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")},o=this&&this.__read||function(r,e){var t="function"==typeof Symbol&&r[Symbol.iterator];if(!t)return r;var n,o,i=t.call(r),a=[];try{for(;(void 0===e||e-- >0)&&!(n=i.next()).done;)a.push(n.value)}catch(r){o={error:r}}finally{try{n&&!n.done&&(t=i.return)&&t.call(i)}finally{if(o)throw o.error}}return a},i=this&&this.__spreadArray||function(r,e,t){if(t||2===arguments.length)for(var n,o=0,i=e.length;o<i;o++)!n&&o in e||(n||(n=Array.prototype.slice.call(e,0,o)),n[o]=e[o]);return r.concat(n||Array.prototype.slice.call(e))};Object.defineProperty(e,"__esModule",{value:!0}),e.GdprManager=void 0;var a=t(822),u=t(670),c=t(554),s=t(779),l=function(){function r(){this.bannerWasShown=!1,this.enabled=!0,this.events=new c.GdprManagerEventHub,this.groups=new Map,this.name="manager",this.description="Manager of GDPR guard groups",this.storage=u.GdprStorage.None,this.required=!1}return r.create=function(e){void 0===e&&(e=[]);var t=new r;return e.forEach((function(r){return t.addGroup(r)})),t},r.prototype.closeBanner=function(){var r=this;this.bannerWasShown=!0,(0,s.visitGdpr)(this,{onEach:function(e){e.enabled?r.events.enable(e.name):r.events.disable(e.name)}})},r.prototype.resetAndShowBanner=function(){this.bannerWasShown=!1},r.prototype.createGroup=function(r,e){return void 0===e&&(e=""),this.addGroup(a.GdprGuardGroup.for(r,e))},r.prototype.addGroup=function(r){return this.groups.set(r.name,r),this},r.prototype.hasGuard=function(r){return this.reduceGroupsPred((function(e){return e.hasGuard(r)}))},r.prototype.getGuard=function(r){var e,t;try{for(var i=n(this.groups),a=i.next();!a.done;a=i.next()){var u=o(a.value,2),c=(u[0],u[1]);if(c.hasGuard(r))return c.getGuard(r)}}catch(r){e={error:r}}finally{try{a&&!a.done&&(t=i.return)&&t.call(i)}finally{if(e)throw e.error}}return null},r.prototype.hasGroup=function(r){return this.reduceGroupsPred((function(e){return e.name===r}))},r.prototype.getGroup=function(r){var e,t;try{for(var i=n(this.groups),a=i.next();!a.done;a=i.next()){var u=o(a.value,2),c=u[0],s=u[1];if(c===r)return s}}catch(r){e={error:r}}finally{try{a&&!a.done&&(t=i.return)&&t.call(i)}finally{if(e)throw e.error}}return null},r.prototype.isEnabled=function(r){return this.reduceGroupsPred((function(e){return e.isEnabled(r)}))},r.prototype.enable=function(){return this.enabled=!0,this.forEachGroup((function(r){return r.enable()}))},r.prototype.disable=function(){return this.enabled=!1,this.forEachGroup((function(r){return r.disable()}))},r.prototype.toggle=function(){return this.enabled?this.disable():this.enable()},r.prototype.makeRequired=function(){return this},r.prototype.enableForStorage=function(r){return this.forEachGroup((function(e){return e.enableForStorage(r)}))},r.prototype.disableForStorage=function(r){return this.forEachGroup((function(e){return e.disableForStorage(r)}))},r.prototype.toggleForStorage=function(r){return this.forEachGroup((function(e){return e.toggleForStorage(r)}))},r.prototype.raw=function(){var r={bannerWasShown:this.bannerWasShown,enabled:this.enabled,groups:[],name:this.name,description:this.description,storage:this.storage,required:this.required};return r.groups=i([],o(this.groups.values()),!1).map((function(r){return r.raw()})),r},r.prototype.reduceGroupsPred=function(r){var e,t;try{for(var i=n(this.groups),a=i.next();!a.done;a=i.next()){var u=o(a.value,2);if(u[0],r(u[1]))return!0}}catch(r){e={error:r}}finally{try{a&&!a.done&&(t=i.return)&&t.call(i)}finally{if(e)throw e.error}}return!1},r.prototype.forEachGroup=function(r){return this.groups.forEach((function(e){return r(e)})),this},r.prototype.getGroups=function(){return i([],o(this.groups.values()),!1)},r}();e.GdprManager=l},554:(r,e)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.GdprManagerEventHub=void 0;var t=function(){function r(){this.eventMap={}}return r.prototype.onEnable=function(r,e){return this.addListener("enable",r,e),this},r.prototype.onDisable=function(r,e){return this.addListener("disable",r,e),this},r.prototype.enable=function(r){return this.executeListeners("enable",r),this},r.prototype.disable=function(r){return this.executeListeners("disable",r),this},r.prototype.tagFor=function(r,e){return"".concat(r,"--").concat(e)},r.prototype.addListener=function(r,e,t){var n=this.tagFor(r,e);n in this.eventMap||(this.eventMap[n]=[]),this.eventMap[n].push(t)},r.prototype.executeListeners=function(r,e){var t,n=this.tagFor(r,e);null===(t=this.eventMap[n])||void 0===t||t.forEach((function(r){return r()}))},r}();e.GdprManagerEventHub=t},670:(r,e)=>{var t;Object.defineProperty(e,"__esModule",{value:!0}),e.GdprStorage=void 0,function(r){r[r.None=1]="None",r[r.Cookie=2]="Cookie",r[r.LocalStorage=4]="LocalStorage",r[r.SessionStorage=8]="SessionStorage",r[r.IndexedDb=16]="IndexedDb",r[r.FileSystem=16]="FileSystem",r[r.ServerStorage=16]="ServerStorage",r[r.All=30]="All"}(t||(t={})),e.GdprStorage=t},860:function(r,e,t){var n,o=this&&this.__extends||(n=function(r,e){return n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,e){r.__proto__=e}||function(r,e){for(var t in e)Object.prototype.hasOwnProperty.call(e,t)&&(r[t]=e[t])},n(r,e)},function(r,e){if("function"!=typeof e&&null!==e)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");function t(){this.constructor=r}n(r,e),r.prototype=null===e?Object.create(e):(t.prototype=e.prototype,new t)}),i=this&&this.__read||function(r,e){var t="function"==typeof Symbol&&r[Symbol.iterator];if(!t)return r;var n,o,i=t.call(r),a=[];try{for(;(void 0===e||e-- >0)&&!(n=i.next()).done;)a.push(n.value)}catch(r){o={error:r}}finally{try{n&&!n.done&&(t=i.return)&&t.call(i)}finally{if(o)throw o.error}}return a},a=this&&this.__spreadArray||function(r,e,t){if(t||2===arguments.length)for(var n,o=0,i=e.length;o<i;o++)!n&&o in e||(n||(n=Array.prototype.slice.call(e,0,o)),n[o]=e[o]);return r.concat(n||Array.prototype.slice.call(e))};Object.defineProperty(e,"__esModule",{value:!0}),e.GdprGroupBuilder=void 0;var u=t(670),c=t(237),s=t(822),l=t(890),d=function(r){function e(e,t,n,o,i,a){var u=r.call(this)||this;return u.parent=e,u.name=t,u.description=n,u.enable=i,u.require=a,u.guards=[],u.storage=o,a&&(u.enable=!0),u}return o(e,r),e.create=function(r,t,n,o,i,a){return void 0===n&&(n=""),void 0===o&&(o=null),void 0===i&&(i=!0),void 0===a&&(a=!1),new e(r,t,n,o||u.GdprStorage.Cookie,i,a)},e.prototype.startGroup=function(e,t,n){return void 0===e&&(e=null),void 0===t&&(t=""),void 0===n&&(n=""),r.prototype.startGroup.call(this,e||this.parent.storage,t,n)},e.prototype.startRequiredGroup=function(r,e,t){return void 0===r&&(r=null),void 0===e&&(e=""),void 0===t&&(t=""),this.startGroup(r,e,t).required()},e.prototype.endGroup=function(){var r=this.require||this.enable,e=s.GdprGuardGroup.for(this.name,this.description,r,this.require);return a(a([],i(this.guards),!1),i(this.groups),!1).forEach((function(r){return e.addGuard(r)})),this.require&&e.makeRequired(),this.parent.groups.push(e),this.parent},e.prototype.withName=function(r){return this.edit((function(e){return e.name=r}))},e.prototype.withDescription=function(r){return this.edit((function(e){return e.description=r}))},e.prototype.storedIn=function(r){return this.edit((function(e){return e.storage=r}))},e.prototype.enabled=function(){return this.edit((function(r){return r.enable=!0}))},e.prototype.disabled=function(){return this.edit((function(r){return r.enable=!1}))},e.prototype.required=function(){return this.edit((function(r){return r.require=!0}))},e.prototype.startGuard=function(r){return void 0===r&&(r=null),l.GdprGuardBuilder.create(this,r||this.storage,this.enable)},e.prototype.startRequiredGuard=function(r){return this.startGuard(r).required()},e.prototype.withEnabledGuard=function(r,e,t){return void 0===e&&(e=""),void 0===t&&(t=null),this.startGuard(t).withName(r).withDescription(e).enabled().endGuard()},e.prototype.withDisabledGuard=function(r,e,t){return void 0===e&&(e=""),void 0===t&&(t=null),this.startGuard(t).withName(r).withDescription(e).disabled().endGuard()},e.prototype.edit=function(r){return r(this),this},e}(c.GdprManagerBuilder);e.GdprGroupBuilder=d},890:(r,e,t)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.GdprGuardBuilder=void 0;var n=t(670),o=t(315),i=function(){function r(r,e,t,n){this.parent=r,this.storage=e,this.enable=t,this.require=n,this.name="",this.description="",n&&(this.enable=!0)}return r.create=function(e,t,o,i){return void 0===t&&(t=n.GdprStorage.Cookie),void 0===o&&(o=!1),void 0===i&&(i=!1),new r(e,t,o,i)},r.prototype.endGuard=function(){var r=this.require||this.enable,e=(0,o.makeGuard)(this.name,this.description,this.storage,this.require,r);return this.require&&e.makeRequired(),this.parent.guards.push(e),this.parent},r.prototype.withName=function(r){return this.edit((function(e){return e.name=r}))},r.prototype.withDescription=function(r){return this.edit((function(e){return e.description=r}))},r.prototype.enabled=function(){return this.edit((function(r){return r.enable=!0}))},r.prototype.disabled=function(){return this.edit((function(r){return r.enable=!1}))},r.prototype.storedIn=function(r){return this.edit((function(e){return e.storage=r}))},r.prototype.required=function(){return this.edit((function(r){return r.require=!0}))},r.prototype.edit=function(r){return r(this),this},r}();e.GdprGuardBuilder=i},237:(r,e,t)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.GdprManagerBuilder=void 0;var n=t(670),o=t(777),i=t(171),a=function(){function r(){this.storage=n.GdprStorage.Cookie,this.groups=[],this.bannerWasShown=!1}return r.make=function(){return new r},r.prototype.withBannerShown=function(r){void 0===r&&(r=!0),this.bannerWasShown=r},r.prototype.startGroup=function(r,e,t,n){return void 0===r&&(r=null),void 0===e&&(e=""),void 0===t&&(t=""),void 0===n&&(n=!0),i.GdprGroupBuilder.create(this,e,t,r,n,!1)},r.prototype.startRequiredGroup=function(r,e,t){return void 0===r&&(r=null),void 0===e&&(e=""),void 0===t&&(t=""),this.startEnabledGroup(r,e,t).required()},r.prototype.startEnabledGroup=function(r,e,t){return void 0===r&&(r=null),void 0===e&&(e=""),void 0===t&&(t=""),this.startGroup(r,e,t,!0).enabled()},r.prototype.startDisabledGroup=function(r,e,t){return void 0===r&&(r=null),void 0===e&&(e=""),void 0===t&&(t=""),this.startGroup(r,e,t,!1).disabled()},r.prototype.build=function(){var r=o.GdprManager.create(this.groups);return r.bannerWasShown=this.bannerWasShown,r},r.prototype.endGroup=function(){return this},r}();e.GdprManagerBuilder=a},171:function(r,e,t){var n=this&&this.__createBinding||(Object.create?function(r,e,t,n){void 0===n&&(n=t);var o=Object.getOwnPropertyDescriptor(e,t);o&&!("get"in o?!e.__esModule:o.writable||o.configurable)||(o={enumerable:!0,get:function(){return e[t]}}),Object.defineProperty(r,n,o)}:function(r,e,t,n){void 0===n&&(n=t),r[n]=e[t]}),o=this&&this.__exportStar||function(r,e){for(var t in r)"default"===t||Object.prototype.hasOwnProperty.call(e,t)||n(e,r,t)};Object.defineProperty(e,"__esModule",{value:!0}),o(t(890),e),o(t(237),e),o(t(860),e)},93:function(r,e,t){var n=this&&this.__createBinding||(Object.create?function(r,e,t,n){void 0===n&&(n=t);var o=Object.getOwnPropertyDescriptor(e,t);o&&!("get"in o?!e.__esModule:o.writable||o.configurable)||(o={enumerable:!0,get:function(){return e[t]}}),Object.defineProperty(r,n,o)}:function(r,e,t,n){void 0===n&&(n=t),r[n]=e[t]}),o=this&&this.__exportStar||function(r,e){for(var t in r)"default"===t||Object.prototype.hasOwnProperty.call(e,t)||n(e,r,t)};Object.defineProperty(e,"__esModule",{value:!0}),o(t(315),e),o(t(822),e),o(t(777),e),o(t(670),e),o(t(554),e),o(t(779),e),o(t(171),e),o(t(891),e),o(t(562),e),o(t(344),e)},562:(r,e,t)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.GdprDeserializer=void 0;var n=t(777),o=t(670),i=t(822),a=t(315),u=["enabled","groups"],c=["guards"],s=["name","enabled","required","description","storage"],l=function(){function r(){}return r.manager=function(r){var e=this;if(!function(r){return u.every((function(e){return e in r}))&&"boolean"==typeof r.enabled&&Array.isArray(r.groups)}(r))return null;var t=r.groups.map((function(r){return e.group(r)})).filter((function(r){return null!==r})),o=n.GdprManager.create([]);return o.enabled=!!r.enabled,o.bannerWasShown=!!r.bannerWasShown,t.forEach((function(r){return o.addGroup(r)})),o},r.group=function(r){var e=this,t=this.guard(r);if(null===t)return null;if(!function(r){return c.every((function(e){return e in r}))&&Array.isArray(r.guards)}(r))return null;var n=i.GdprGuardGroup.for(t.name,t.description,t.enabled,t.required);return r.guards.map((function(r){return c.every((function(e){return e in r}))?e.group(r):e.guard(r)})).filter((function(r){return null!==r})).forEach((function(r){return n.addGuard(r)})),n},r.guard=function(r){return function(r){return s.every((function(e){return e in r}))&&"string"==typeof r.name&&"boolean"==typeof r.enabled&&"boolean"==typeof r.required&&"string"==typeof r.description&&"number"==typeof r.storage&&r.storage in o.GdprStorage}(r)?(0,a.makeGuard)(r.name,r.description,r.storage,!!r.required,!!r.enabled):null},r}();e.GdprDeserializer=l},344:function(r,e){var t=this&&this.__awaiter||function(r,e,t,n){return new(t||(t=Promise))((function(o,i){function a(r){try{c(n.next(r))}catch(r){i(r)}}function u(r){try{c(n.throw(r))}catch(r){i(r)}}function c(r){var e;r.done?o(r.value):(e=r.value,e instanceof t?e:new t((function(r){r(e)}))).then(a,u)}c((n=n.apply(r,e||[])).next())}))},n=this&&this.__generator||function(r,e){var t,n,o,i,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:u(0),throw:u(1),return:u(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function u(u){return function(c){return function(u){if(t)throw new TypeError("Generator is already executing.");for(;i&&(i=0,u[0]&&(a=0)),a;)try{if(t=1,n&&(o=2&u[0]?n.return:u[0]?n.throw||((o=n.return)&&o.call(n),0):n.next)&&!(o=o.call(n,u[1])).done)return o;switch(n=0,o&&(u=[2&u[0],o.value]),u[0]){case 0:case 1:o=u;break;case 4:return a.label++,{value:u[1],done:!1};case 5:a.label++,n=u[1],u=[0];continue;case 7:u=a.ops.pop(),a.trys.pop();continue;default:if(!((o=(o=a.trys).length>0&&o[o.length-1])||6!==u[0]&&2!==u[0])){a=0;continue}if(3===u[0]&&(!o||u[1]>o[0]&&u[1]<o[3])){a.label=u[1];break}if(6===u[0]&&a.label<o[1]){a.label=o[1],o=u;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(u);break}o[2]&&a.ops.pop(),a.trys.pop();continue}u=e.call(r,a)}catch(r){u=[6,r],n=0}finally{t=o=0}if(5&u[0])throw u[1];return{value:u[0]?u[1]:void 0,done:!0}}([u,c])}}};Object.defineProperty(e,"__esModule",{value:!0}),e.GdprSaviorAdapter=void 0;var o=function(){function r(){}return r.prototype.exists=function(r){return void 0===r&&(r=!0),t(this,void 0,void 0,(function(){return n(this,(function(e){switch(e.label){case 0:return[4,this.restore(r)];case 1:return[2,null!==e.sent()]}}))}))},r.prototype.storeIfNotExists=function(r){return t(this,void 0,void 0,(function(){return n(this,(function(e){switch(e.label){case 0:return[4,this.exists()];case 1:return[2,!!e.sent()||this.store(r)]}}))}))},r.prototype.restoreOrCreate=function(r){return t(this,void 0,void 0,(function(){var e,t;return n(this,(function(n){switch(n.label){case 0:return[4,this.restore()];case 1:return(e=n.sent())?[3,3]:[4,r()];case 2:return t=n.sent(),this.updateSharedManager(t),t.bannerWasShown&&t.closeBanner(),[2,t];case 3:return e.bannerWasShown&&e.closeBanner(),[2,e]}}))}))},r.prototype.check=function(){return t(this,void 0,void 0,(function(){return n(this,(function(r){switch(r.label){case 0:return[4,Promise.resolve()];case 1:return r.sent(),[4,this.exists(!0)];case 2:return r.sent(),[2]}}))}))},r}();e.GdprSaviorAdapter=o},891:(r,e)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.GdprSerializer=void 0;var t=function(){function r(){}return r.serialize=function(r){return r.raw()},r}();e.GdprSerializer=t},779:(r,e,t)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.visitGdpr=void 0;var n=t(777),o=t(822);e.visitGdpr=function(r,t){var i=void 0===t?{}:t,a=i.onManager,u=void 0===a?function(){}:a,c=i.onGroup,s=void 0===c?function(){}:c,l=i.onGuard,d=void 0===l?function(){}:l,f=i.onEach,p=void 0===f?function(){}:f,h={onManager:u,onGroup:s,onGuard:d,onEach:p};r instanceof n.GdprManager?(u(r),p(r),r.getGroups().forEach((function(r){return(0,e.visitGdpr)(r,h)}))):r instanceof o.GdprGuardGroup?(s(r),p(r),r.getGuards().forEach((function(r){return(0,e.visitGdpr)(r,h)}))):(d(r),p(r))}}},e={};return function t(n){var o=e[n];if(void 0!==o)return o.exports;var i=e[n]={exports:{}};return r[n].call(i.exports,i,i.exports,t),i.exports}(93)})(),r.exports=e()}},e={};function t(n){var o=e[n];if(void 0!==o)return o.exports;var i=e[n]={exports:{}};return r[n].call(i.exports,i,i.exports,t),i.exports}t.d=(r,e)=>{for(var n in e)t.o(e,n)&&!t.o(r,n)&&Object.defineProperty(r,n,{enumerable:!0,get:e[n]})},t.o=(r,e)=>Object.prototype.hasOwnProperty.call(r,e),t.r=r=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(r,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(r,"__esModule",{value:!0})};var n={};return(()=>{"use strict";t.r(n),t.d(n,{HtmlGdprGuardError:()=>o,NoCheckboxError:()=>a,NoManagerDefinitionError:()=>c,NoNameError:()=>l,restoreHtmlGdprManager:()=>A});var r,e=(r=function(e,t){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,e){r.__proto__=e}||function(r,e){for(var t in e)Object.prototype.hasOwnProperty.call(e,t)&&(r[t]=e[t])},r(e,t)},function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}),o=function(r){function t(e){return r.call(this,e)||this}return e(t,r),t}(Error),i=function(){var r=function(e,t){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,e){r.__proto__=e}||function(r,e){for(var t in e)Object.prototype.hasOwnProperty.call(e,t)&&(r[t]=e[t])},r(e,t)};return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}}(),a=function(r){function e(t){return void 0===t&&(t=e.defaultMessage),r.call(this,t)||this}return i(e,r),e.defaultMessage="No checkbox found for that guard",e}(o),u=function(){var r=function(e,t){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,e){r.__proto__=e}||function(r,e){for(var t in e)Object.prototype.hasOwnProperty.call(e,t)&&(r[t]=e[t])},r(e,t)};return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}}(),c=function(r){function e(t){return void 0===t&&(t=e.defaultMessage),r.call(this,t)||this}return u(e,r),e.defaultMessage="No definition found for the GDPR manager",e}(o),s=function(){var r=function(e,t){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,e){r.__proto__=e}||function(r,e){for(var t in e)Object.prototype.hasOwnProperty.call(e,t)&&(r[t]=e[t])},r(e,t)};return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}}(),l=function(r){function e(t){return void 0===t&&(t=e.defaultMessage),r.call(this,t)||this}return s(e,r),e.defaultMessage="Guard definition is missing the guard's name",e}(o),d=t(845),f=function(r){return!!r&&!/^\s*$/.test(r)},p=function(r,e,t){void 0===t&&(t="gdpr-guard-name");var n=r.dataset[function(r){return r.replace(/-(\w)/g,(function(r,e){return e.toUpperCase()}))}(e)];if(f(n))return n.trim();var o,i,a=(o=r,i="[data-".concat(t,"]"),function(r,e){for(var t=0;t<r.childElementCount;t+=1){var n=r.children.item(t);if(n&&e(n))return n}return null}(o,(function(r){return r.matches(i)}))),u=null==a?void 0:a.dataset[t];if(!f(u)){var c=null==a?void 0:a.textContent;if(f(c))return c.trim();throw new l}return u.trim()},h=function(r,e){var t,n,o,i=[function(){return document.getElementById(e)},function(){return r.querySelector('[type="checkbox"][name="'.concat(e,'"]'))},function(){return r.querySelector('[type="checkbox"][data-gdpr-checkbox]')}];try{for(var u=function(r){var e="function"==typeof Symbol&&Symbol.iterator,t=e&&r[e],n=0;if(t)return t.call(r);if(r&&"number"==typeof r.length)return{next:function(){return r&&n>=r.length&&(r=void 0),{value:r&&r[n++],done:!r}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")}(i),c=u.next();!c.done;c=u.next()){var s=(0,c.value)();if(null===(o=null==s?void 0:s.matches)||void 0===o?void 0:o.call(s,"input[type='checkbox']"))return s}}catch(r){t={error:r}}finally{try{c&&!c.done&&(n=u.return)&&n.call(u)}finally{if(t)throw t.error}}throw new a},v=function(r){var e;if(r.hasAttribute("data-gdpr-guard-description"))return r.dataset.gdprGuardDescription;var t=r.querySelector("[data-gdpr-guard-description]");return null!==(e=null==t?void 0:t.textContent)&&void 0!==e?e:null},y=function(r){if(r.hasAttribute("data-gdpr-guard-storage")){var e=r.dataset.gdprGuardStorage;if(e&&e in d.GdprStorage)return d.GdprStorage[e]}return null},b=function(r,e){return e.required||r.hasAttribute("data-gdpr-guard-required")},g=function(r,e,t){void 0===t&&(t=!1);var n=function(){e.setAttribute("checked","checked"),e.setAttribute("disabled","disabled")},o=function(){e.setAttribute("required","required")},i=function(){r.setAttribute("data-gdpr-guard-required","")};t?(i(),n(),o()):e.required?(i(),n()):r.hasAttribute("data-gdpr-guard-required")&&(n(),o())},G=function(r,e){var t="function"==typeof Symbol&&r[Symbol.iterator];if(!t)return r;var n,o,i=t.call(r),a=[];try{for(;(void 0===e||e-- >0)&&!(n=i.next()).done;)a.push(n.value)}catch(r){o={error:r}}finally{try{n&&!n.done&&(t=i.return)&&t.call(i)}finally{if(o)throw o.error}}return a},w=function(r,e,t){if(t||2===arguments.length)for(var n,o=0,i=e.length;o<i;o++)!n&&o in e||(n||(n=Array.prototype.slice.call(e,0,o)),n[o]=e[o]);return r.concat(n||Array.prototype.slice.call(e))},m=function(r,e,t){var n=e.startGroup(),o=p(r,"gdpr-group");n.withName(o);var i=h(r,o),a=[{name:o,checkbox:i}],u=t||b(r,i);g(r,i,u),u?n.required().enabled():i.checked?n.enabled():n.disabled();var c=v(r);c&&n.withDescription(c);var s=y(r);null!==s&&n.storedIn(s);var l=S(r,n,u);return n.endGroup(),a.push.apply(a,w([],G(l),!1)),a},S=function(r,e,t){void 0===t&&(t=!1);var n=[];return function(r,e){for(var t=0;t<r.childElementCount;t+=1){var n=r.children.item(t);n&&e(n)}}(r,(function(r){if(null==r?void 0:r.matches("[data-gdpr-group]")){var o=m(r,e,t);n.push.apply(n,w([],G(o),!1))}else if(null==r?void 0:r.matches("[data-gdpr-guard]")){var i=function(r,e,t){var n=e.startGuard(),o=p(r,"gdpr-guard");n.withName(o);var i=h(r,o),a=t||b(r,i);g(r,i,a),a?n.required().enabled():i.checked?n.enabled():n.disabled();var u=v(r);u&&n.withDescription(u);var c=y(r);return null!==c&&n.storedIn(c),n.endGuard(),{name:o,checkbox:i}}(r,e,t);n.push(i)}})),n},_=function(r,e,t){document.querySelectorAll(e).forEach((function(e){e.addEventListener(r,t)}))},E=function(){return E=Object.assign||function(r){for(var e,t=1,n=arguments.length;t<n;t++)for(var o in e=arguments[t])Object.prototype.hasOwnProperty.call(e,o)&&(r[o]=e[o]);return r},E.apply(this,arguments)},x=function(r,e,t){document.querySelectorAll(e).forEach((function(e){var n=e.dataset.gdprOnEnable;r.hasGuard(n)?r.events.onEnable(n,(function(){var r;if(e){var n=e.matches("script"),o=e;e=void 0;var i=n?document.createElement("script"):o.cloneNode(!0);Object.assign(i,E(E({},o),{type:n?"text/javascript":null!==(r=o.type)&&void 0!==r?r:void 0})),n&&(o.getAttributeNames().forEach((function(r){var e=o.getAttribute(r);i.setAttribute(r,e)})),i.textContent=o.textContent),t(i),i.removeAttribute("data-gdpr-on-enable"),o.remove(),document.head.appendChild(i)}})):e&&e.remove()}))},k=function(r,e,t,n){return new(t||(t=Promise))((function(o,i){function a(r){try{c(n.next(r))}catch(r){i(r)}}function u(r){try{c(n.throw(r))}catch(r){i(r)}}function c(r){var e;r.done?o(r.value):(e=r.value,e instanceof t?e:new t((function(r){r(e)}))).then(a,u)}c((n=n.apply(r,e||[])).next())}))},O=function(r,e){var t,n,o,i,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:u(0),throw:u(1),return:u(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function u(i){return function(u){return function(i){if(t)throw new TypeError("Generator is already executing.");for(;a;)try{if(t=1,n&&(o=2&i[0]?n.return:i[0]?n.throw||((o=n.return)&&o.call(n),0):n.next)&&!(o=o.call(n,i[1])).done)return o;switch(n=0,o&&(i=[2&i[0],o.value]),i[0]){case 0:case 1:o=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,n=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(!((o=(o=a.trys).length>0&&o[o.length-1])||6!==i[0]&&2!==i[0])){a=0;continue}if(3===i[0]&&(!o||i[1]>o[0]&&i[1]<o[3])){a.label=i[1];break}if(6===i[0]&&a.label<o[1]){a.label=o[1],o=i;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(i);break}o[2]&&a.ops.pop(),a.trys.pop();continue}i=e.call(r,a)}catch(r){i=[6,r],n=0}finally{t=o=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,u])}}},A=function(r,e){var t=void 0===e?{}:e,n=t.gdprEl,o=void 0===n?void 0:n,i=t.autoCloseBanner,a=void 0===i||i,u=t.bindEventHandlersHook,s=void 0===u?function(){}:u,l=t.addGuardsBeforeHook,v=void 0===l?function(){}:l,y=t.addGuardsAfterHook,b=void 0===y?function(){}:y,g=t.onDeclineAllErrorHook,G=void 0===g?function(r,e){return console.error("[HtmlGdprGuard @ onDeclineAllErrorHook]",{didStore:r,err:e})}:g,w=t.onAllowAllErrorHook,S=void 0===w?function(r,e){return console.error("[HtmlGdprGuard @ onAllowAllErrorHook]",{didStore:r,err:e})}:w,E=t.onSaveErrorHook,A=void 0===E?function(r,e){return console.error("[HtmlGdprGuard @ onSaveErrorHook]",{didStore:r,err:e})}:E,q=t.onCancelErrorHook,j=void 0===q?function(r,e){return console.error("[HtmlGdprGuard @ onCancelErrorHook]",{didStore:r,err:e})}:q,M=t.onBannerClose,P=void 0===M?function(){}:M,B=t.onBannerOpen,C=void 0===B?function(){}:B;return k(void 0,void 0,void 0,(function(){var e,t,n,i,u,l,y,g,w;return O(this,(function(E){switch(E.label){case 0:if(void 0===o&&void 0===(o=null!==(w=document.querySelector("[data-gdpr]"))&&void 0!==w?w:void 0))throw new c;return e=function(r){var e=r,t=r.dataset.gdpr,n="";if(f(t))n=t;else{var o=r.querySelector("[data-gdpr-manager]");if(!o)throw new c;n=p(e=o,"gdpr-manager")}return{managerEl:e,managerCheckbox:h(e,n),managerName:n}}(o),t=e.managerEl,n=e.managerCheckbox,i=d.GdprManagerBuilder.make(),v(i),u=function(r,e){return(t=r,"[data-gdpr-group]",function(r,e){for(var t=[],n=0;n<r.childElementCount;n+=1){var o=r.children.item(n);o&&e(o)&&t.push(o)}return t}(t,(function(r){return r.matches("[data-gdpr-group]")}))).flatMap((function(r){return m(r,e,!1)}));var t}(t,i),b(i),l=function(){return k(void 0,void 0,void 0,(function(){return O(this,(function(r){return[2,i.build()]}))}))},[4,r.exists(!1)];case 1:return y=E.sent(),[4,r.restoreOrCreate(l)];case 2:return function(r){x(r,"script[type='text'][data-gdpr-on-enable]",(function(r){r.setAttribute("type","text/javascript")}))}(g=E.sent()),function(r){x(r,"link[href][data-gdpr-on-enable]",(function(r){r.setAttribute("rel","stylesheet")}))}(g),function(r,e,t,n){var o=function(r,e){n&&(r.checked&&!e.enabled||!r.checked&&e.enabled)&&r.click()};o(e,r),e.addEventListener("click",(function(){r.toggle(),t.forEach((function(e){var t=e.name,n=e.checkbox,o=r.getGuard(t);n.checked=o.enabled}))})),t.forEach((function(e){var n=e.name,i=e.checkbox,a=r.getGuard(n),u=function(r){var e=new Set;return r instanceof d.GdprGuardGroup&&r.getGuards().forEach((function(r){e.add(r.name);var t=u(r);Array.from(t).forEach((function(r){return e.add(r)}))})),e},c=u(a),s=t.filter((function(r){var e=r.name;return c.has(e)}));o(i,a),i.addEventListener("click",(function(){a.toggle(),s.forEach((function(e){var t=e.name,n=e.checkbox,o=r.getGuard(t);n.checked=o.enabled}))}))}))}(g,n,u,y),function(r,e,t,n){_("click","[data-gdpr-open]",(function(e){e.preventDefault(),r.resetAndShowBanner(),t.onBannerOpen()})),_("click","[data-gdpr-decline-all]",(function(n){n.preventDefault(),r.disable(),r.closeBanner(),e.store(r.raw()).then((function(e){if(e)try{t.onBannerClose()}catch(r){t.onDeclineAllErrorHook(e,r)}else r.resetAndShowBanner(),t.onDeclineAllErrorHook(e)})).catch((function(e){r.resetAndShowBanner(),t.onDeclineAllErrorHook(!1,e)}))})),_("click","[data-gdpr-allow-all]",(function(n){n.preventDefault(),r.enable(),r.closeBanner(),e.store(r.raw()).then((function(e){if(e)try{t.onBannerClose()}catch(r){t.onAllowAllErrorHook(e,r)}else r.resetAndShowBanner(),t.onAllowAllErrorHook(e)})).catch((function(e){r.resetAndShowBanner(),t.onAllowAllErrorHook(!1,e)}))})),_("click","[data-gdpr-cancel]",(function(r){var o,i,a,u;r.preventDefault(),o=void 0,i=void 0,u=function(){var r;return function(r,e){var t,n,o,i,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:u(0),throw:u(1),return:u(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function u(i){return function(u){return function(i){if(t)throw new TypeError("Generator is already executing.");for(;a;)try{if(t=1,n&&(o=2&i[0]?n.return:i[0]?n.throw||((o=n.return)&&o.call(n),0):n.next)&&!(o=o.call(n,i[1])).done)return o;switch(n=0,o&&(i=[2&i[0],o.value]),i[0]){case 0:case 1:o=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,n=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(!((o=(o=a.trys).length>0&&o[o.length-1])||6!==i[0]&&2!==i[0])){a=0;continue}if(3===i[0]&&(!o||i[1]>o[0]&&i[1]<o[3])){a.label=i[1];break}if(6===i[0]&&a.label<o[1]){a.label=o[1],o=i;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(i);break}o[2]&&a.ops.pop(),a.trys.pop();continue}i=e.call(r,a)}catch(r){i=[6,r],n=0}finally{t=o=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,u])}}}(this,(function(o){switch(o.label){case 0:return o.trys.push([0,6,,7]),[4,e.exists(!1)];case 1:return o.sent()?[4,e.restore(!0)]:[3,3];case 2:return o.sent(),[3,5];case 3:return[4,e.restoreOrCreate(n)];case 4:o.sent(),o.label=5;case 5:return[3,7];case 6:return r=o.sent(),t.onCancelErrorHook(!0,r),[3,7];case 7:return[2]}}))},new((a=void 0)||(a=Promise))((function(r,e){function t(r){try{c(u.next(r))}catch(r){e(r)}}function n(r){try{c(u.throw(r))}catch(r){e(r)}}function c(e){var o;e.done?r(e.value):(o=e.value,o instanceof a?o:new a((function(r){r(o)}))).then(t,n)}c((u=u.apply(o,i||[])).next())}))})),_("click","[data-gdpr-save]",(function(n){n.preventDefault(),r.closeBanner(),e.store(r.raw()).then((function(e){if(e)try{t.onBannerClose()}catch(r){t.onSaveErrorHook(e,r)}else r.resetAndShowBanner(),t.onSaveErrorHook(e)})).catch((function(e){r.resetAndShowBanner(),t.onSaveErrorHook(e)}))}))}(g,r,{onDeclineAllErrorHook:G,onAllowAllErrorHook:S,onSaveErrorHook:A,onCancelErrorHook:j,onBannerClose:P,onBannerOpen:C},l),s(g.events,g),a&&g.bannerWasShown?(g.closeBanner(),P()):(g.resetAndShowBanner(),C()),[2,g]}}))}))}})(),n})()));
//# sourceMappingURL=index.js.map